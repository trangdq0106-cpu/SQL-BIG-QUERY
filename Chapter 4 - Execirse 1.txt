SELECT station_id, name, address, number_of_docks
FROM `bigquery-public-data.austin_bikeshare.bikeshare_stations`
WHERE station_id IN
(
  SELECT start_station_id
  FROM `bigquery-public-data.austin_bikeshare.bikeshare_trips` 
  WHERE EXTRACT(YEAR FROM start_time)=2022
  ORDER BY duration_minutes DESC
  LIMIT 10
)
ORDER BY number_of_docks DESC;
--
SELECT station_id, name, address, number_of_docks
FROM `bigquery-public-data.austin_bikeshare.bikeshare_stations`
WHERE station_id NOT IN
(
  SELECT start_station_id
  FROM `bigquery-public-data.austin_bikeshare.bikeshare_trips` 
  WHERE EXTRACT(YEAR FROM start_time)=2013
)
ORDER BY name;
--
SELECT station_id, name, address, number_of_docks
FROM `bigquery-public-data.austin_bikeshare.bikeshare_stations` 
WHERE number_of_docks=
(
  SELECT MAX(number_of_docks)
  FROM `bigquery-public-data.austin_bikeshare.bikeshare_stations` 
);
SELECT station_id, name, address, number_of_docks
FROM `bigquery-public-data.austin_bikeshare.bikeshare_stations` 
WHERE number_of_docks=
(
  SELECT MIN(number_of_docks)
  FROM `bigquery-public-data.austin_bikeshare.bikeshare_stations` 
);
--
WITH q
AS
(
  SELECT station_id
  FROM `bigquery-public-data.austin_bikeshare.bikeshare_stations` 
  WHERE number_of_docks=
  (
    SELECT MAX(number_of_docks)
    FROM `bigquery-public-data.austin_bikeshare.bikeshare_stations` 
  )
)
SELECT trip_id, bikeid, start_station_id, start_station_name, duration_minutes
FROM `bigquery-public-data.austin_bikeshare.bikeshare_trips` 
WHERE EXTRACT(YEAR FROM start_time)=2022 AND start_station_id IN
(
  SELECT station_id FROM q
)
ORDER BY start_station_id, duration_minutes DESC
LIMIT 1000;
--
SELECT station_id, name, address, number_of_docks
FROM `bigquery-public-data.austin_bikeshare.bikeshare_stations`
WHERE station_id IN
(
  SELECT start_station_id
  FROM `bigquery-public-data.austin_bikeshare.bikeshare_trips` 
  WHERE EXTRACT(YEAR FROM start_time)=2022 AND bikeid='920'
  ORDER BY duration_minutes DESC
  LIMIT 10
)
ORDER BY name;
--
SELECT trip_id, bikeid, start_station_id, start_station_name, duration_minutes
FROM `bigquery-public-data.austin_bikeshare.bikeshare_trips` 
WHERE EXTRACT(YEAR FROM start_time)=2022 AND start_station_id IN
(
  SELECT station_id
  FROM `bigquery-public-data.austin_bikeshare.bikeshare_stations`
  WHERE address LIKE '%Red River%'
) AND duration_minutes<4;